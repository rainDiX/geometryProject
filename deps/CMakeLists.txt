cmake_minimum_required(VERSION 3.25)

project(geometryProjectDeps C CXX)

set(CMAKE_POSITION_INDEPENDENT_CODE ON)

include(ExternalProject)

set(DCMAKE_PREFIX_PATH ${CMAKE_INSTALL_PREFIX})
message(STATUS "CMAKE_INSTALL_PREFIX "${CMAKE_INSTALL_PREFIX}"")


ExternalProject_Add(
    SDL2
    URL "https://www.libsdl.org/release/SDL2-2.28.5.tar.gz"
    INSTALL_DIR "${CMAKE_INSTALL_PREFIX}"
    CMAKE_ARGS
      -DCMAKE_INSTALL_PREFIX:PATH=${CMAKE_INSTALL_PREFIX}
)

if (UNIX)
  if (NOT APPLE)
    set(egl_enabled ON)
    list(APPEND vtk_platform_dependencies egl)
  endif ()
endif ()

ExternalProject_Add(
    VTK
    URL "https://www.vtk.org/files/release/9.3/VTK-9.3.0.tar.gz"
    INSTALL_DIR "${CMAKE_INSTALL_PREFIX}"
    CMAKE_ARGS
      -DCMAKE_INSTALL_PREFIX:PATH=${CMAKE_INSTALL_PREFIX}
      -DVTK_BUILD_TESTING:BOOL=OFF
      -DVTK_ENABLE_LOGGING:BOOL=OFF
      -DVTK_ENABLE_WRAPPING:BOOL=OFF
      -DVTK_GROUP_ENABLE_Rendering:STRING=DEFAULT
      -DVTK_GROUP_ENABLE_StandAlone:STRING=DEFAULT
      -DVTK_GROUP_ENABLE_Qt:STRING=DONT_WANT
      -DVTK_LEGACY_REMOVE:BOOL=ON
      -DVTK_MODULE_ENABLE_VTK_CommonSystem:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_FiltersGeneral:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_FiltersGeometry:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOCityGML:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOGeometry:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOImage:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOImport:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOPLY:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOParallel:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_IOXML:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_ImagingCore:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_ImagingHybrid:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_InteractionStyle:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_InteractionWidgets:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingAnnotation:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingCore:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingExternal:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingLabel:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingOpenGL2:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_RenderingVolumeOpenGL2:STRING=YES
      -DVTK_MODULE_ENABLE_VTK_TestingCore:STRING=YES
      -DVTK_OPENGL_HAS_EGL:BOOL=${egl_enabled}
      -DVTK_SMP_ENABLE_STDTHREAD:BOOL=ON
      -DVTK_USE_X:BOOL=OFF
      -DVTK_USE_SDL2:BOOL=ON
      -DVTK_SMP_IMPLEMENTATION_TYPE:STRING=STDThread
      -DVTK_VERSIONED_INSTALL:BOOL=OFF
      -DVTK_WRAP_PYTHON:BOOL=OFF
)

add_dependencies(VTK SDL2)

ExternalProject_Add(
    EigenExternalProject
    URL "https://gitlab.com/libeigen/eigen/-/archive/3.4.0/eigen-3.4.0.tar.gz"
    INSTALL_DIR "${CMAKE_INSTALL_PREFIX}"
    CMAKE_ARGS
      -DCMAKE_INSTALL_PREFIX:PATH=${CMAKE_INSTALL_PREFIX}
)